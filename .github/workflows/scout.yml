name: Global-Macro-Scout

on:
  schedule:
    - cron: '*/5 * * * *'
  workflow_dispatch:

concurrency:
  group: macro-scouting
  cancel-in-progress: true

jobs:
  run-scout:
    runs-on: ubuntu-latest
    permissions:
      contents: write

    steps:
      - name: Checkout
        uses: actions/checkout@v3
        with:
          # ğŸš¨ ì „ì²´ íˆìŠ¤í† ë¦¬ë¥¼ ê°€ì ¸ì™€ì•¼ ê¼¬ì´ì§€ ì•ŠìŠµë‹ˆë‹¤.
          fetch-depth: 0

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'

      - name: Install
        run: pip install requests beautifulsoup4 pandas python-dateutil

      - name: Run
        run: python scout_jp.py

      # ğŸš¨ [ë¬´ì ì˜ ë‹¨ê³„] ì§ì ‘ git ëª…ë ¹ì–´ë¥¼ ì“°ëŠ” ëŒ€ì‹  ì „ìš© ë„êµ¬ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
      - name: Auto Commit and Push
        uses: stefanzweifel/git-auto-commit-action@v4
        with:
          commit_message: "ğŸ“¡ ì •ì°° ë³´ê³ : DB ì—…ë°ì´íŠ¸ (${{ github.event.schedule }})"
          file_pattern: 'macro_intelligence.db' # DB íŒŒì¼ë§Œ íƒ€ê²ŸíŒ…
          # ğŸš¨ ì¶©ëŒ ë°œìƒ ì‹œ ì›ê²©ì˜ ë‚´ìš©ì„ ë¨¼ì € ê°€ì ¸ì™€ í•©ì¹©ë‹ˆë‹¤.
          push_options: '--force' # í˜¼ì ì“°ëŠ” DBë¼ë©´ forceê°€ ê°€ì¥ ê¹”ë”í•©ë‹ˆë‹¤.
